// JavaScript Document
/**
 * author:leon
 * by http://www.yun-app.cn
 */


/**
 * container ['#loading']
 */
function Loading(container) {
	this.svgObj=this;
	this.isPlay=true;
	this.container=container;
}

/**
 * 鍒濆鍖�
 * @return {[type]} [description]
 */
Loading.prototype.init=function(){
	
/*<!--	var svgIntro=
	'<svg version="1.1" id="&#x56FE;&#x5C42;_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="92.445px" height="123.14px" viewBox="0 0 92.445 123.14" style="enable-background:new 0 0 92.445 123.14;" xml:space="preserve">'+

	'<path style="fill:none;stroke:#DE182D;stroke-miterlimit:10;" d="M23.43,10.25C29.627,4.084,37.06,1.001,45.73,1c8.703,0,16.121,3.084,22.25,9.25c4.266,4.264,7.058,9.155,8.375,14.675c0.579,2.406,0.871,4.932,0.875,7.575c0.004,2.4-0.23,4.718-0.7,6.95c-1.257,5.761-4.106,10.859-8.55,15.3c-6.129,6.165-13.547,9.249-22.25,9.25c-8.669-0.001-16.104-3.085-22.3-9.25c-6.133-6.13-9.199-13.547-9.2-22.25C14.231,23.83,17.298,16.413,23.43,10.25z"/>'+

	'<path style="fill:none;stroke:#D01E2D;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" d="M58.73,22.675c0,0-0.916-7.25-8.208-8.208c-7.21-0.947-10.375,6.542-10.375,6.542s-5.167-0.667-7.667,2.333s-1.833,6.505-1.833,6.505s-8,1.328-7.208,8.578c0.812,7.439,8.708,6.958,8.708,6.958H58.98c0,0,9,0.007,9-8.521c0-7.896-6.791-8.438-6.791-8.438"/>'+

	'<path style="fill:none;stroke:#D01E2D;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" d="M40.815,25.967c0,0-2.709-0.311-4.127,1.792c-1.208,1.792-0.875,3.417-0.875,3.417"/>'+

	'<path style="fill:none;stroke:#5A5B5B;stroke-miterlimit:10;" d="M58.9,86.883h1.449c2.399,0,3.602-1.584,3.602-4.75c0-2.967-1.201-4.45-3.602-4.45H58.9V86.883z M70.4,82.232c0,4.468-3.084,6.7-9.25,6.7H58.9v9.3H52.3V75.583h9.8C67.632,75.583,70.4,77.799,70.4,82.232z M84.25,82.133c0-2.967-1.199-4.45-3.6-4.45h-1.449v9.2h1.449C83.05,86.883,84.25,85.299,84.25,82.133z M79.201,88.933v9.3h-6.602V75.583H82.4c5.533,0,8.301,2.216,8.301,6.648c0,4.468-3.084,6.7-9.25,6.7L79.201,88.933L79.201,88.933z M85.65,108.633c-0.334,0.366-0.5,0.833-0.5,1.4v4.948h-2.5v-8.648h2.5v1.398h0.051c0.633-1.065,1.566-1.6,2.799-1.6c1.9,0,2.851,1.184,2.851,3.55v5.3h-2.5v-4.8c0-1.398-0.5-2.1-1.5-2.1C86.382,108.083,85.984,108.267,85.65,108.633z M80.9,108.683c-0.601-0.398-1.234-0.6-1.9-0.6c-0.766,0-1.383,0.232-1.85,0.7c-0.467,0.466-0.699,1.1-0.699,1.898s0.215,1.435,0.648,1.9c0.434,0.434,1.032,0.648,1.801,0.648c0.666,0,1.334-0.198,2-0.6v2.05c-0.633,0.334-1.5,0.5-2.601,0.5c-1.334,0-2.399-0.398-3.2-1.2c-0.8-0.8-1.199-1.833-1.199-3.1c0-1.467,0.434-2.634,1.301-3.5c0.865-0.833,2.033-1.25,3.5-1.25c0.965,0,1.699,0.134,2.199,0.399V108.683L80.9,108.683z M63.65,108.083c-0.601,0-1.066,0.217-1.4,0.648c-0.367,0.435-0.549,1-0.549,1.7v0.75c0,0.602,0.166,1.102,0.5,1.5c0.332,0.367,0.766,0.55,1.299,0.55c0.633,0,1.117-0.232,1.451-0.698c0.365-0.5,0.549-1.2,0.549-2.102C65.5,108.866,64.882,108.083,63.65,108.083z M61.701,106.333v1.35h0.049c0.666-1.033,1.601-1.55,2.801-1.55c1.101,0,1.968,0.384,2.601,1.15c0.6,0.767,0.899,1.815,0.899,3.148c0,1.435-0.35,2.584-1.051,3.45c-0.731,0.866-1.684,1.3-2.85,1.3c-1.066,0-1.867-0.416-2.4-1.25h-0.049v5.05h-2.5v-12.648H61.701z M72.05,112.883c0.267,0.267,0.4,0.583,0.4,0.95c0,0.398-0.135,0.732-0.4,1c-0.301,0.232-0.668,0.35-1.1,0.35c-0.4,0-0.75-0.116-1.051-0.35c-0.269-0.268-0.4-0.602-0.4-1c0-0.367,0.15-0.685,0.451-0.95c0.266-0.233,0.615-0.35,1.049-0.35C71.4,112.533,71.75,112.649,72.05,112.883z M1,85.533v-2h24.7v2H12.2L8.6,96.732h9.3c0.066,0,0.134-0.016,0.2-0.05c0.065-0.033,0.116-0.083,0.149-0.148c0.066-0.066,0.116-0.117,0.149-0.15c0-0.066-0.018-0.15-0.05-0.25l-1.601-6.85h6.399l1.7,7.05c0.065,0.3,0.065,0.583,0,0.85c-0.066,0.3-0.2,0.566-0.399,0.8c-0.2,0.233-0.434,0.417-0.7,0.552c-0.267,0.1-0.55,0.148-0.851,0.148H1.55l4.2-13.148L1,85.533L1,85.533z M1.95,76.982v-1.948h22.8v1.948H1.95z M39.25,80.982l-2.851,10.052h5.551L39.25,80.982z M35.75,93.333l-1.45,4.898h-2.6l6.699-22.648H44.2l6.3,22.648h-6.6l-1.351-4.898H35.75z M44,110.883l-1.649,0.2c-0.899,0.1-1.351,0.5-1.351,1.2c0,0.333,0.116,0.6,0.351,0.8c0.199,0.2,0.482,0.3,0.851,0.3c0.533,0,0.966-0.184,1.3-0.55c0.333-0.367,0.5-0.816,0.5-1.352L44,110.883L44,110.883z M42.399,107.883c-1,0-1.966,0.316-2.899,0.95v-1.95c0.399-0.233,0.935-0.417,1.601-0.55c0.634-0.134,1.184-0.2,1.649-0.2c2.435,0,3.649,1.217,3.649,3.65v5.198H44v-1.25h-0.05c-0.601,0.968-1.467,1.45-2.601,1.45c-0.801,0-1.45-0.232-1.95-0.7c-0.5-0.466-0.75-1.1-0.75-1.898c0-1.634,0.982-2.602,2.95-2.9l2.399-0.3C44,108.383,43.467,107.883,42.399,107.883z M53,108.083c-0.6,0-1.065,0.217-1.399,0.648c-0.365,0.435-0.55,1-0.55,1.7v0.75c0,0.602,0.166,1.102,0.5,1.5c0.332,0.367,0.767,0.55,1.3,0.55c0.635,0,1.116-0.232,1.45-0.698c0.365-0.5,0.55-1.2,0.55-2.102C54.849,108.866,54.234,108.083,53,108.083z M57.4,110.433c0,1.435-0.351,2.584-1.051,3.45c-0.732,0.866-1.685,1.3-2.851,1.3c-1.065,0-1.867-0.416-2.399-1.25h-0.05v5.05h-2.5v-12.648h2.5v1.35h0.05c0.668-1.033,1.602-1.55,2.801-1.55c1.1,0,1.967,0.384,2.6,1.15C57.099,108.05,57.4,109.1,57.4,110.433z M24.95,108.633c-0.334,0.366-0.5,0.833-0.5,1.4v4.948h-2.5v-8.648h2.5v1.398h0.05c0.633-1.065,1.566-1.6,2.8-1.6c1.9,0,2.851,1.184,2.851,3.55v5.3h-2.5v-4.8c0-1.398-0.5-2.1-1.5-2.1C25.684,108.083,25.283,108.267,24.95,108.633z M17.149,106.333H19.7v8.648h-2.551v-1.3c-0.666,1-1.55,1.5-2.649,1.5c-2.033,0-3.05-1.217-3.05-3.648v-5.2H14v5c0,1.267,0.5,1.898,1.5,1.898c0.5,0,0.899-0.166,1.2-0.5c0.3-0.365,0.449-0.85,0.449-1.448V106.333z M32.35,111.232v-1.75h4.601v1.75H32.35z M5.7,111.732c0.133,0.334,0.217,0.718,0.25,1.15H6c0.033-0.3,0.116-0.667,0.25-1.1l1.75-5.45h2.5l-3.601,9.398c-0.833,2.2-2.066,3.302-3.699,3.302c-0.667,0-1.167-0.067-1.5-0.2v-2c0.333,0.166,0.699,0.25,1.1,0.25c0.7,0,1.185-0.334,1.45-1l0.5-1.102l-3.5-8.648h2.8L5.7,111.732z"/>'+
	'</svg>';
-->*/

	if(!$(this.container).length)return false;
	$(this.container).html(svgIntro);
	
	var $path=$(this.container).find('path');
	var len=$path.length;
	
	for(var i=0;i<len;i++){
		var pathNode=$path.eq(i)[0];
		var svgLen = pathNode.getTotalLength();
		// 娓呴櫎涔嬪墠鐨勫姩浣�
		pathNode.style.transition = pathNode.style.WebkitTransition ='none';
		// 璁剧疆璧峰鐐�
		pathNode.style.strokeDasharray = svgLen + ' ' + svgLen;
		pathNode.style.strokeDashoffset = svgLen;
		// 鑾峰彇涓€涓尯鍩燂紝鑾峰彇鐩稿叧鐨勬牱寮忥紝璁╂祻瑙堝櫒瀵绘壘涓€涓捣濮嬬偣銆�
		pathNode.getBoundingClientRect();
		console.log(svgLen);
		//this.pathIn(i,pathNode);
		this.pathIn(i,pathNode);
	}
	
}

/**
 * svg杩涘満鍔ㄧ敾
 */
Loading.prototype.pathIn = function (i,pathNode) {
	if(!this.isPlay && !$(this.container).length)return;
	var _this=this.svgObj;
	var dur=1,delay=0,easing='ease-in-out';
	/*鍔ㄧ敾鑺傚鎺у埗*/
	if(i==0){dur=1;delay=0;}
	if(i==1){dur=1;delay=0;}
	if(i==2){dur=1;delay=1;}
	if(i==3){dur=5;delay=1;easing='linear'}

	// 瀹氫箟鍔ㄤ綔
	pathNode.style.transition = pathNode.style.WebkitTransition = 'stroke-dashoffset '+dur+'s '+easing+' '+delay+'s';
	// Go!
	pathNode.style.strokeDashoffset = '0';
	//if(i==3){
		window.setTimeout(function(){
			_this.pathOut(i,pathNode)
		},2000)
	//}
};

/**
 * svg閫€鍦哄姩鐢�
 */
Loading.prototype.pathOut = function (i,pathNode) {
	if(!this.isPlay && !$(this.container).length)return;
	var _this=this.svgObj;
	var svgLen = pathNode.getTotalLength();

	/*鍔ㄧ敾鑺傚鎺у埗*/
	var dur=1,delay=0,easing='ease-in-out';
	if(i==0){dur=1;delay=0;}
	if(i==1){dur=1;delay=0;}
	if(i==2){dur=0.5;delay=0.5;}
	if(i==3){dur=1;delay=0;easing='linear'}
	// 瀹氫箟鍔ㄤ綔
	pathNode.style.transition = pathNode.style.WebkitTransition = 'stroke-dashoffset '+dur+'s '+easing+' '+delay+'s';
	// Go!
	pathNode.style.strokeDashoffset = svgLen;
	window.setTimeout(function(){
		_this.pathIn(i,pathNode)
	},1500)
};

/**
 * 閿€姣�
 */
Loading.prototype.destroy=function(){
	this.isPlay=false;
}


/*
var loading=new Loading('.loading');
loading.init();


$('body').click(function(){
	loading.destroy();
	loading=null;
	console.log('ff')
})*/